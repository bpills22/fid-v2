import { DeploymentBuilder, BuildOptions } from '@edgio/core/deploy';
import { ExtendedConfig, RenderMode } from '../types';
import { BuilderOptions } from './BuilderOptions';
import { NextConfig } from '../next.types';
export default class NextBuilder {
    protected builder: DeploymentBuilder;
    protected srcDir: string;
    protected distDir: string;
    protected edgioConfig: ExtendedConfig;
    protected nextConfig: NextConfig;
    protected renderMode: RenderMode;
    protected defaultLocale?: string;
    protected buildId?: string;
    protected prerenderManifest?: any;
    protected nextVersion?: string | null;
    protected buildCommand: string;
    constructor({ buildCommand }: BuilderOptions);
    protected get srcDirAbsolute(): string;
    protected get distDirAbsolute(): string;
    protected get nextRootDir(): string;
    build(options: BuildOptions): Promise<void>;
    /**
     * This function is used in build to get all destinations that are set by
     * rewrites. This is used to make sure that this is bundled as we don't handle
     * rewrites on CDN, but Next does. If we don't bundle this, the rewrites
     * on lambda will fail when it is sent to Next server, as it won't regenerate
     * static pages.
     * @returns List of all destinations from rewrites and redirects
     */
    getRewritesDestinations(): Promise<string[]>;
    getPrerenderManifest(): any;
    /**
     * There is an issue with Next12 where their server source code is not bundled into single file.
     * This leads to very long cold starts on the platform ~5s+, with bundling everything into single
     * we are able to get under ~1s load time from the Lambda disk.
     * We are not seeing these problems with Next 13
     */
    optimizeAndCompileServerBuild(): Promise<void>;
    /**
     * Builds the Next app using the Next CLI
     */
    buildNextApp(): Promise<void>;
    /**
     * Copies the output of the Next standalone build to the lambda dir.
     */
    addStandaloneBuildAssets(): Promise<void>;
    /**
     * Handles bundling the lambda for Next.js prior to 12.2.0. This includes both 'serverless' and 'experimental-serverless-trace'
     * targets.
     */
    addLegacyBuildAssets(): Promise<void>;
    /**
     * Move all static pages from the lambda dir to the s3 dir. We don't need them in the lambda
     * since we're serving them from s3. so that @edgio/core doesn't.  Also, having them be present
     * in the lambda will make NextRoutes add duplicate routes for each.
     */
    addSSGPages(srcDir: string, destDir: string): void;
    /**
     * Builds the next.config.js file for standalone build
     * with merged default values from the Next.js server.
     */
    private buildStandaloneNextConfig;
    /**
     * Builds the next.config.js file for serverless builds.
     */
    private buildServerlessNextConfig;
    /**
     * Validates that it contains all required Edgio plugins
     */
    private validateNextConfig;
    private buildServiceWorker;
}
