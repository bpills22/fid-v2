"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const constants_1 = require("../constants");
const global_helpers_1 = require("@edgio/core/lambda/global.helpers");
const path_1 = require("path");
const paths_1 = require("@edgio/core/deploy/paths");
/**
 * Returns the path relative to current working directory
 * where the next project or build is located.
 * However, when the project is built in NPM/YARN workspaces, the path is relative to the workspace root.
 */
function getNextRootDir() {
    var _a;
    const edgioAppDir = ((_a = global_helpers_1.EdgioRuntimeGlobal.runtimeOptions) === null || _a === void 0 ? void 0 : _a.fs.edgio.lambda.app.value) || paths_1.JS_APP_DIR;
    const nextRootDirFilePath = (0, path_1.join)(edgioAppDir, constants_1.NEXT_ROOT_DIR_FILE);
    if ((0, fs_1.existsSync)(nextRootDirFilePath)) {
        return (0, path_1.resolve)(edgioAppDir, (0, fs_1.readFileSync)(nextRootDirFilePath, 'utf-8'));
    }
    return process.cwd();
}
exports.default = getNextRootDir;
